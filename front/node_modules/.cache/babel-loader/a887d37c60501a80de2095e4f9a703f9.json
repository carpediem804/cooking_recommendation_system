{"remainingRequest":"C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\src\\views\\addProfile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\src\\views\\addProfile.vue","mtime":1544641613821},{"path":"C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1544186292430},{"path":"C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1544186290334},{"path":"C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1544186292430},{"path":"C:\\Users\\mhmrm\\Desktop\\찌르레기\\team_project\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1544186326628}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport firebase from 'firebase';\nimport BField from \"buefy/src/components/field/Field\";\nimport BFieldBody from \"buefy/src/components/field/FieldBody\";\nimport BInput from \"buefy/src/components/input/Input\";\nimport axios from 'axios';\nimport BUpload from \"buefy/src/components/upload/Upload\";\nexport default {\n  name: 'addProfile',\n  methods: {\n    addInfo: function addInfo() {\n      var _this = this;\n\n      var user = this.$store.state.user;\n      var db = firebase.firestore();\n\n      if (user === null) //로그인 상태가 아니면\n        {\n          alert('로그인ㄱㄱ');\n        } else {\n        db.collection('users').doc(user.email).update({\n          nickName: document.getElementById('nickName').value\n        });\n      }\n\n      axios.defaults.headers.post['Content-Type'] = 'multipart/form-data';\n      var formData = new FormData();\n      formData.append('file', this.file);\n      db.collection('users').doc(user.email).get().then(function (doc) {\n        _this.nickName = doc.data().nickName;\n        console.log(_this.nickName);\n      });\n      axios.post('http://localhost:8000/upload/userimg', formData, {\n        params: {\n          nickName: this.nickName,\n          uid: this.$store.state.user.uid\n        }\n      }).then(function (res) {\n        if (res.data) {\n          alert(\"수정되었습니다\");\n        } else {\n          alert(\"수정 실패\");\n        }\n      });\n    },\n    upload: function upload(name, files) {\n      axios.defaults.headers.post['Content-Type'] = 'multipart/form-data'; //  const formData = new FormData();\n      //   formData.append(name, files[0], files[0].name);\n\n      this.createImage(files[0]);\n      console.log(files);\n      this.file = files[0];\n      var formData = new FormData();\n      formData.append('file', this.file);\n      this.imageUp = true;\n    },\n    createImage: function createImage(file) {\n      var image = new Image();\n      var reader = new FileReader();\n      var vm = this;\n\n      reader.onload = function (e) {\n        vm.imgFile = e.target.result;\n      };\n\n      reader.readAsDataURL(file);\n    }\n  },\n  data: function data() {\n    return {\n      nickName: '',\n      sex: '',\n      dropFiles: null,\n      imageUp: false\n    };\n  },\n  components: {\n    BUpload: BUpload,\n    BInput: BInput,\n    BFieldBody: BFieldBody,\n    BField: BField,\n    firebase: firebase\n  },\n  mounted: function mounted() {\n    (function () {\n      var user = firebase.auth().currentUser;\n\n      if (user == null) {\n        alert(\"로그인부터 ㄱㄱ\");\n        window.location.href = \"/\";\n      }\n    })();\n  }\n};",{"version":3,"sources":["addProfile.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div id=\"addProfile\" class=\"modal-card\" style=\"width:300px\">\r\n        <div class=\"modal-card-head\">\r\n            <p>프로필 변경</p>\r\n        </div>\r\n        <section class=\"modal-card-body\" >\r\n            <b-field>\r\n                <div class=\"dropbox\">\r\n                    <input class=\"input-file\" type=\"file\" name=\"file\"\r\n                           @change=\"upload($event.target.name, $event.target.files)\"\r\n                           @drop=\"upload($event.target.name, $event.target.files)\">\r\n                    <div class=\"content has-text-centered\" v-if=\"!imageUp\">\r\n                        <i class=\"fas fa-image fa-3x\"></i>\r\n                    </div>\r\n                    <div v-else>\r\n                        <img :src=\"imgFile\" />\r\n                    </div>\r\n                </div>\r\n\r\n            </b-field>\r\n            <div v-if=\"dropFiles\">\r\n                <span class=\"file-name\">\r\n                    {{ dropFiles.name }}\r\n                </span>\r\n            </div>\r\n            <b-field>\r\n                <b-input type=\"text\" placeholder=\"닉네임\" v-model=\"nickName\" id=\"nickName\"></b-input>\r\n            </b-field>\r\n            <b-field class=\"has-text-centered\">\r\n                <button class=\"button\" value=\"수정\" v-on:click=\"addInfo()\">수정</button>\r\n            </b-field>\r\n        </section>\r\n\r\n\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport firebase from 'firebase'\r\nimport BField from \"buefy/src/components/field/Field\";\r\nimport BFieldBody from \"buefy/src/components/field/FieldBody\";\r\nimport BInput from \"buefy/src/components/input/Input\";\r\nimport axios from 'axios'\r\nimport BUpload from \"buefy/src/components/upload/Upload\";\r\n\r\nexport default{\r\n    name:'addProfile',\r\n    methods:{\r\n        addInfo:function(){\r\n            let user=this.$store.state.user\r\n            var db=firebase.firestore();\r\n\r\n            if(user===null)//로그인 상태가 아니면\r\n            {\r\n              alert('로그인ㄱㄱ')\r\n            }\r\n            else\r\n            {\r\n                db.collection('users').doc(user.email).update({\r\n                nickName:document.getElementById('nickName').value,\r\n            })\r\n            }\r\n\r\n            axios.defaults.headers.post['Content-Type'] = 'multipart/form-data';\r\n            let formData = new FormData();\r\n            formData.append('file', this.file);\r\n            db.collection('users').doc(user.email).get().then((doc)=>{\r\n                this.nickName=doc.data().nickName\r\n                console.log(this.nickName);\r\n            })\r\n\r\n            axios.post('http://localhost:8000/upload/userimg', formData,{\r\n                params: {\r\n                        nickName:this.nickName,\r\n                        uid : this.$store.state.user.uid\r\n                }}).then((res)=>{\r\n                if(res.data)\r\n                {\r\n                    alert(\"수정되었습니다\")\r\n                }\r\n                else\r\n                {\r\n                    alert(\"수정 실패\")\r\n                }\r\n            });\r\n\r\n        },\r\n        upload(name, files) {\r\n\r\n            axios.defaults.headers.post['Content-Type'] = 'multipart/form-data';\r\n\r\n            //  const formData = new FormData();\r\n            //   formData.append(name, files[0], files[0].name);\r\n            this.createImage(files[0]);\r\n            console.log(files)\r\n            this.file = files[0]\r\n            let formData = new FormData()\r\n            formData.append('file', this.file)\r\n            this.imageUp=true\r\n\r\n        },\r\n        createImage(file) {\r\n            var image = new Image();\r\n            var reader = new FileReader();\r\n            var vm = this;\r\n\r\n            reader.onload = (e) => {\r\n                vm.imgFile = e.target.result;\r\n            };\r\n            reader.readAsDataURL(file);\r\n        },\r\n        /*db에서 읽는법\r\n        readDb:function(){\r\n        var db=firebase.firestore();\r\n        db.collection('users').doc('1').get().then((doc)=>{\r\n          console.log(doc.data().name)\r\n        })\r\n      }*/\r\n    },\r\n    data(){\r\n        return{\r\n            nickName:'',\r\n            sex:'',\r\n            dropFiles:null,\r\n            imageUp:false\r\n        }\r\n    },\r\n    components:{\r\n        BUpload,\r\n        BInput,\r\n        BFieldBody,\r\n        BField,\r\n        firebase\r\n    },\r\n    mounted(){\r\n        (function(){\r\n           let user=firebase.auth().currentUser;\r\n           if(user==null)\r\n           {\r\n               alert(\"로그인부터 ㄱㄱ\")\r\n               window.location.href=\"/\"\r\n           }\r\n        })()\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n    .dropbox {\r\n        outline: 2px dashed #aaa;\r\n        background: #7fb4dd;\r\n        width: 100px;\r\n        height: 100px;\r\n        position: relative;\r\n        margin: 0 auto;\r\n    }\r\n    .input-file{\r\n        position: absolute;\r\n        opacity: 0;\r\n        width:100%;\r\n        height:100%;\r\n        top:0;\r\n        left:0;\r\n        z-index: 3;\r\n    }\r\n</style>\r\n"],"sourceRoot":"src\\views"}]}